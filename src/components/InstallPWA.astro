---

---

<div
  id="install-pwa"
  class="fixed bottom-20 left-1/2 -translate-x-1/2 transform hidden"
>
  <div class="bg-white rounded-lg shadow-lg p-4 flex items-center gap-4">
    <div>
      <h3 class="font-semibold mb-1">Installer Decival</h3>
      <p class="text-sm text-gray-600">
        Accédez à l'application même hors ligne
      </p>
    </div>
    <button
      id="install-button"
      class="bg-accent text-white px-4 py-2 rounded-lg hover:bg-accent/90"
    >
      Installer
    </button>
  </div>
</div>

<script>
  let deferredPrompt;

  window.addEventListener("beforeinstallprompt", (e) => {
    e.preventDefault();
    deferredPrompt = e;
    const installPWA = document.getElementById("install-pwa");
    installPWA?.classList.remove("hidden");
  });

  document
    .getElementById("install-button")
    ?.addEventListener("click", async () => {
      if (!deferredPrompt) return;

      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;

      if (outcome === "accepted") {
        console.log("Application installée");
      }

      deferredPrompt = null;
      document.getElementById("install-pwa")?.classList.add("hidden");
    });

  // Cacher le bouton si l'app est déjà installée
  window.addEventListener("appinstalled", () => {
    document.getElementById("install-pwa")?.classList.add("hidden");
    deferredPrompt = null;
  });
</script>
